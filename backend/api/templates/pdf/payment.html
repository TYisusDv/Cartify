<!DOCTYPE html>
<html>
<head>
  <title>Ticket</title>
  <link rel="stylesheet" type="text/css" href="http://127.0.0.1:8000/static/css/payment.css?v={{uuid}}">
</head>
<body>
  <div class="payment">
    <div class="logo-content">
      <div class="logo"></div>
    </div>
    <div class="company-info">
      <p class="font-bold">GRUPO INNOVACIÓN EMPRESARIAL SOCIEDAD ANÓNIMA</p>
      <p class="font-bold" style="margin-top: 10px;">MI HOGAR ELECTRODOMÉSTICOS</p>
      <p>{{address.description}}</p>
    </div>
    <div class="company-more">
      <div class="item">
        <p>Nit:</p> <span>{{nit.description}}</span>
      </div>
      <div class="item">
        <p>Tel:</p> <span>{{tel.description}}</span>
      </div>
      <div class="item">
        <p>Sucursal:</p> <span>{{payment.location.name}}</span>
      </div>
      <div class="item">
        <p>Atendio:</p> <span>{{payment.user.first_name}}</span>
      </div>
    </div>
    <div class="client-info">
      <div class="item">
        <p>Cliente:</p> <span>{{sale.client.person.firstname}} {{sale.client.person.middlename}} {{sale.client.person.lastname}} {{sale.client.person.second_lastname}}</span>
      </div>
      <div class="item">
        <p>Tel. Cliente:</p> <span>{{sale.client.person.phone}}</span>
      </div>
    </div>
    <div class="payment-info">
      <div class="item">
        <p>No. Recibo:</p> <span>{{payment.no}}</span>
      </div>
      <div class="item">
        <p>Fecha:</p> <span id="payment-date">{{ payment_date_utc }}</span>
      </div>
    </div>
    <table>
      <thead>
        <tr>
          <th>#</th>
          <th>Producto</th>
          <th>Precio</th>
          <th>Total</th>
        </tr>
      </thead>
      <tbody>
        {% for item in sale.inventory %}
        <tr>
          <td>{{item.quantity}}</td>
          <td>{{item.product.name}}</td>
          <td>Q{{item.price}}</td>
          <td>Q{{item.total}}</td>
        </tr>
        {% endfor %}
        <tr style="border-top: 1px solid black;">
          <td></td>
          <td class="font-bold">TOTAL</td>
          <td></td>
          <td>Q{{sale.total}}</td>
        </tr>
      </tbody>
    </table>
    <div class="pay">
      <div class="item">
        <p>{% if sale.type == 2 %}Abono:{% else %}Subtotal:{% endif %}</p> <span>Q{{payment.subtotal|floatformat:2}}</span>
      </div>
      {% if sale.type == 2 %}
      <div class="item">
        <p>Recargo:</p> <span>Q{{payment.surcharge|floatformat:2}}</span>
      </div>
      {% endif %}
      <div class="item">
        <p>{{payment.payment_method.name}}:</p> <span>Q{{payment.commission|floatformat:2}}</span>
      </div>
      <div class="item">
        <p>Descuento:</p> <span>Q{{payment.discount|floatformat:2}}</span>
      </div>
      <div class="item">
        <p>Total:</p> <span>Q{{payment.total|floatformat:2}}</span>
      </div>
    </div>
    {% if sale.type == 2 %}
    <p class="p-credit">Todos tus pagos</p>
    <table style="font-size: 0.95rem;">
      <thead>
        <tr>
          <th>No. Recibo</th>
          <th>Total</th>
          <th>Abonado</th>
          <th>Fecha limite</th>
        </tr>
      </thead>
      <tbody>
        {% for item in sale.sale_payments %}
        <tr>
          <td>{% if item.no %}{{item.no}}{% else %}-{% endif %}</td>
          <td>Q{{item.subtotal|floatformat:2}}</td>
          <td>Q{{item.total_without|floatformat:2}}</td>
          <td>{{item.date_limit_formatted}}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
    {% endif %}
    <div class="logo-content">
      <img src="data:image/png;base64,{{ qr }}" alt="QR Code" style="margin-top: 10px; width: 130px;"/>
    </div> 
    <div class="footer">
      <p class="font-bold">Recibo generado en</p>
      <p>{{payment.id}}</p>
    </div>  
  </div>
  <!--
  <script>
      document.addEventListener("DOMContentLoaded", function() {
          var paymentDateUTC = "{{ payment_date_utc }}";
          
          var paymentDate = new Date(paymentDateUTC);
          
          var options = {
              year: 'numeric',
              month: '2-digit',
              day: '2-digit',
              hour: '2-digit',
              minute: '2-digit',
              hour12: true
          };
          
          var localDate = paymentDate.toLocaleString('es-MX', options);
          document.getElementById('payment-date').textContent = localDate;
      });
  </script>
  -->
</body>
</html>